package ru.org.bbcode;

import junit.framework.Assert;
import org.junit.Test;

/**
 * Created by IntelliJ IDEA.
 * User: hizel
 * Date: 7/6/11
 * Time: 12:47 AM
 */
public class VulnerabilityTest {
    private final Parser parser = new Parser();
    @Test
    public void splinterTest1(){ // http://www.linux.org.ru/forum/linux-org-ru/6448266
        Assert.assertEquals(parser.parse("[url=http://www.fishing.org/][user]splinter[/user][/url]")
                .renderXHtml(),
                "<div><a href=\"http://www.fishing.org/\"></a><span style=\"white-space: nowrap\"><img src=\"/img/tuxlor.png\"><a style=\"text-decoration: none\" href='/people/splinter/profile'>splinter</a></span></div>");
    }
}
